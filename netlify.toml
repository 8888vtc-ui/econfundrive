[build]
  publish = "dist"
  command = "npm run build"
  base = "."

[functions]
  node_bundler = "esbuild"
  directory = "netlify/functions"

[functions.environment]
  IMAGE_PROMPT_VTC = "Photo réaliste d'une berline ou d'un van de luxe utilisé comme chauffeur privé VTC dans une ville côtière méditerranéenne générique, chauffeur discret en tenue business, ambiance élégante mais sobre, sans aucun logo de marque, sans nom de lieu réel, sans monument ou bâtiment clairement reconnaissable."
  RESEND_API_KEY = "@resend_api_key"
  BOOKING_EMAIL = "8888VTC@gmail.com"
  OPENAI_API_KEY = "@openai_api_key"
  DEEPSEEK_API_KEY = "@deepseek_api_key"
  DEEPSEEK_MODEL = "deepseek-chat"

# Security Headers
[[headers]]
  for = "/*"
  [headers.values]
    X-Frame-Options = "DENY"
    X-Content-Type-Options = "nosniff"
    X-XSS-Protection = "1; mode=block"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"
    Content-Security-Policy = "default-src 'self'; script-src 'self' 'unsafe-inline' https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://www.google-analytics.com https://api.openai.com; frame-ancestors 'none';"

# Cache static assets
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache fonts
[[headers]]
  for = "/assets/fonts/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

# Cache images
[[headers]]
  for = "/assets/img/*"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

# HTML cache
[[headers]]
  for = "/*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"
